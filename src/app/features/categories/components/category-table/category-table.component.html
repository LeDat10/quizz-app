<nz-spin [nzSpinning]="loading$ | async" nzTip="Loading Categories...">
  <nz-table
    nzShowPagination
    nzShowSizeChanger
    [nzData]="categories"
    [nzPageIndex]="(tableState$ | async)?.pageIndex || 1"
    [nzPageSize]="(tableState$ | async)?.pageSize || 10"
    [nzTotal]="(tableState$ | async)?.total || 0"
    [nzFrontPagination]="false"
    (nzPageIndexChange)="onPageIndexChange($event)"
    (nzPageSizeChange)="onPageSizeChange($event)"
    [nzScroll]="{ x: '992px' }"
  >
    <thead>
      <tr>
        <th
          [nzChecked]="checked"
          [nzWidth]="'100px'"
          [nzIndeterminate]="indeterminate"
          (nzCheckedChange)="onAllChecked($event)"
          nzLeft
        ></th>

        <th>Image</th>
        <th nzShowSort>Title</th>
        <th nzShowSort>Position</th>
        <th>Status</th>
        <th nzWidth="150px" nzRight>Action</th>
      </tr>
    </thead>

    <tbody>
      @for (data of categories; track data.id) {
      <tr>
        <td
          [nzChecked]="isItemSelected(data.id)"
          (nzCheckedChange)="onItemChecked(data.id, $event)"
          nzLeft
        ></td>
        <td>
          <img
            [src]="data.thumbnail"
            [alt]="data.title"
            class="w-17 h-17 object-cover"
          />
        </td>
        <td>{{ data.title }}</td>
        <td>
          <nz-input-number
            [(ngModel)]="data.position"
            nzMin="1"
          ></nz-input-number>
        </td>
        <td>
          <button
            class="cursor-pointer"
            (click)="onChangeStatus({ id: data.id, status: data.status })"
          >
            <nz-tag [nzColor]="statusTypeMap[data.status]">{{
              data.status
            }}</nz-tag>
          </button>
        </td>
        <td nzRight>
          <div nz-row>
            <div nz-col nz-tooltip nzTooltipTitle="Detail">
              <button nz-button nzType="text">
                <nz-icon nzType="eye" nzTheme="outline" />
              </button>
            </div>
            <div nz-col nz-tooltip nzTooltipTitle="Edit">
              <button nz-button nzType="link" (click)="onCategoryEdit(data.id)">
                <nz-icon nzType="edit" nzTheme="outline" />
              </button>
            </div>
            <div nz-col nz-tooltip nzTooltipTitle="Delete">
              <button nz-button nzType="text" nzDanger>
                <nz-icon nzType="delete" nzTheme="outline" />
              </button>
            </div>
          </div>
        </td>
      </tr>
      }
    </tbody>
  </nz-table>

  <app-action-bar
    [selectedQuantity]="getSelectionCount()"
    (positionClicked)="onUpdatePositionMultiple()"
    (statusClicked)="onUpdateStatusMultiple($event)"
    (closeActionBarClicked)="onCloseActionBar()"
  ></app-action-bar>
</nz-spin>
